generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Student {
  id                   String        @id @default(cuid())
  collegeId            String?
  name                 String
  email                String        @unique
  passwordHash         String
  course               String
  branch               String
  year                 String
  status               String
  cgpa                 Float
  skills               String
  certifications       String
  resume               String?
  portfolio            String?
  linkedinProfile      String?
  githubProfile        String?
  aiInterviewScore     Int
  skillMatchPercentage Int
  projectExperience    Int
  createdAt            DateTime      @default(now())
  applications         Application[]
  college              College?      @relation(fields: [collegeId], references: [id])
  documents            documents[]
}

model College {
  id           String      @id @default(cuid())
  name         String
  code         String      @unique
  email        String      @unique
  passwordHash String      @default("")
  location     String
  isVerified   Boolean     @default(false)
  createdAt    DateTime    @default(now())
  drives       Drive[]
  Recruiter    Recruiter[]
  students     Student[]
}

model Recruiter {
  id           String   @id @default(cuid())
  collegeId    String?
  name         String
  company      String
  email        String   @unique
  passwordHash String
  status       String
  createdAt    DateTime @default(now())
  drives       Drive[]
  College      College? @relation(fields: [collegeId], references: [id])
}

model Drive {
  id           String        @id @default(cuid())
  recruiterId  String
  collegeId    String
  position     String
  type         String
  salary       String
  location     String
  skills       String
  openings     Int
  description  String
  status       String
  postedDate   DateTime      @default(now())
  applications Application[]
  college      College       @relation(fields: [collegeId], references: [id])
  recruiter    Recruiter     @relation(fields: [recruiterId], references: [id])
}

model Application {
  id                      String      @id @default(cuid())
  studentId               String
  driveId                 String
  status                  String
  appliedDate             DateTime    @default(now())
  lastUpdate              DateTime    @updatedAt
  aiInterviewScheduled    DateTime?
  aiInterviewCompleted    DateTime?
  technicalRoundScheduled DateTime?
  technicalRoundCompleted DateTime?
  hrRoundScheduled        DateTime?
  hrRoundCompleted        DateTime?
  finalRoundScheduled     DateTime?
  finalRoundCompleted     DateTime?
  drive                   Drive       @relation(fields: [driveId], references: [id])
  student                 Student     @relation(fields: [studentId], references: [id])
  interviews              Interview[]
}

model Interview {
  id            String      @id @default(cuid())
  applicationId String
  mode          String
  date          DateTime
  time          String
  location      String
  feedback      String?
  status        String
  createdAt     DateTime    @default(now())
  updatedAt     DateTime
  application   Application @relation(fields: [applicationId], references: [id])
}

model calendar_events {
  id          String   @id
  userId      String
  userType    String
  title       String
  description String?
  startTime   DateTime
  endTime     DateTime
  type        String
  status      String
  location    String?
  isOnline    Boolean  @default(false)
  meetingUrl  String?
  attendees   String
  createdAt   DateTime @default(now())
  updatedAt   DateTime
}

model documents {
  id          String   @id
  studentId   String
  title       String
  type        String
  publicId    String   @unique
  url         String
  format      String
  size        Int
  isPrimary   Boolean  @default(false)
  description String?
  tags        String
  uploadedAt  DateTime @default(now())
  updatedAt   DateTime
  Student     Student  @relation(fields: [studentId], references: [id], onDelete: Cascade)
}

model notification_preferences {
  id           String   @id
  userId       String
  userType     String
  emailEnabled Boolean  @default(true)
  pushEnabled  Boolean  @default(true)
  inAppEnabled Boolean  @default(true)
  preferences  String
  createdAt    DateTime @default(now())
  updatedAt    DateTime

  @@unique([userId, userType])
}

model notifications {
  id        String   @id
  userId    String
  userType  String
  title     String
  message   String
  type      String
  isRead    Boolean  @default(false)
  data      String?
  createdAt DateTime @default(now())
}
